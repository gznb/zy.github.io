<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="THREE.CSS3DObject &#x3D; function ( element ) {  THREE.Object3D.call( this );  this.element &#x3D; element;  this.element.style.position &#x3D; &#39;absolute&#39;;  this.addEventListener( &#39;removed&#39;, function ( event ) {   i">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2021/09/29/blog-LeadPage/scripts/ierenderer/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="THREE.CSS3DObject &#x3D; function ( element ) {  THREE.Object3D.call( this );  this.element &#x3D; element;  this.element.style.position &#x3D; &#39;absolute&#39;;  this.addEventListener( &#39;removed&#39;, function ( event ) {   i">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-09-29T04:56:54.297Z">
<meta property="article:modified_time" content="2021-08-16T01:27:41.619Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-blog-LeadPage/scripts/ierenderer" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/29/blog-LeadPage/scripts/ierenderer/" class="article-date">
  <time class="dt-published" datetime="2021-09-29T04:56:54.297Z" itemprop="datePublished">2021-09-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        THREE.CSS3DObject = function ( element ) {
 THREE.Object3D.call( this );
 this.element = element;
 this.element.style.position = 'absolute';
 this.addEventListener( 'removed', function ( event ) {
  if ( this.element.parentNode !== null ) {
   this.element.parentNode.removeChild( this.element );
   for ( var i = 0, l = this.children.length; i < l; i ++ ) {
    this.children[ i ].dispatchEvent( event );
   }
  }
 } );
};
THREE.CSS3DObject.prototype = Object.create( THREE.Object3D.prototype );
THREE.CSS3DSprite = function ( element ) {
 THREE.CSS3DObject.call( this, element );
};
THREE.CSS3DSprite.prototype = Object.create( THREE.CSS3DObject.prototype );
ERNO.IeCss3DRenderer = function ( cube ) {
 var _width, _height;
 var _widthHalf, _heightHalf;
 var matrix = new THREE.Matrix4();
 var domElement = document.createElement( 'div' );
 domElement.style.overflow = 'hidden';
 this.domElement = domElement;
 var cameraElement = document.createElement( 'div' );
 domElement.appendChild( cameraElement );
 this.setClearColor = function () {
 };
 this.setSize = function ( width, height ) {
  _width = width;
  _height = height;
  _widthHalf = _width / 2;
  _heightHalf = _height / 2;
  domElement.style.width = width + 'px';
  domElement.style.height = height + 'px';;
  cameraElement.style.width = width + 'px';
  cameraElement.style.height = height + 'px';
 };
 var epsilon = function ( value ) {
  return Math.abs( value ) < 0.0001 ? 0 : value;
 };
 var getObjectCSSTransform = function(){
   var position = new THREE.Vector3(),
    scale   = new THREE.Vector3(),
    euler   = new THREE.Euler(),
    quaternion = new THREE.Quaternion(),
    style;
   euler._quaternion = quaternion;
   quaternion._euler = euler;
   return function ( matrix ) {
   matrix.decompose( position, quaternion, scale );
    return 'translate3d(-50%,-50%,0) translate3d(' + epsilon( position.x ) + 'px, ' + epsilon( position.y ) + 'px, ' + epsilon( position.z ) + 'px) '
      + 'rotateX(' + epsilon( euler.x ) + 'rad) rotateY(' + epsilon( euler.y ) + 'rad) rotateZ(' + epsilon( euler.z ) + 'rad) '
      + 'scale3d(' + epsilon( scale.x ) + ', ' + epsilon( scale.y ) + ', ' + epsilon( scale.z ) + ')';
   };
  }()
 var cameraMatrix = new THREE.Matrix4();
 var matrixWorld = new THREE.Matrix4();
 var renderCount;
 var projectVector = function(){
  var viewProjectionMatrix = new THREE.Matrix4();
  return function( vector, camera ) {
   viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );
   return vector.applyProjection( viewProjectionMatrix );
  }
 }()
 var camOririgin = new THREE.Matrix4();
 var fovOffset = new THREE.Matrix4();
 var screenCenter = new THREE.Matrix4();
 var fov;
 var renderObject = function ( object, camera ) {
  matrixWorld.multiplyMatrices( cameraMatrix, object.matrixWorld );
  matrixWorld.elements[4] *= -1;
  matrixWorld.elements[5] *= -1;
  matrixWorld.elements[6] *= -1;
  matrixWorld.elements[7] *= -1;
  style =  getObjectCSSTransform( matrixWorld  )
  var element = object.element;
  element.style.WebkitTransform = style;
  element.style.MozTransform = style;
  element.style.oTransform = style;
  element.style.transform = style;
  element.style.WebkitPerspective = fov + "px";
  element.style.MozPerspective = fov + "px";
  element.style.oPerspective = fov + "px";
  element.style.perspective = fov + "px";
  if ( element.parentNode !== cameraElement ) {
   cameraElement.appendChild( element );
  }
 };
 function painterSort( a, b ){
  return a.z - b.z;
 }
 function sortVerts( obj, camera ){
  var halfCubeletSize = cube.cubeletSize * 0.5;
  obj.userData.points[0].set( -halfCubeletSize, -halfCubeletSize, 0 ).applyMatrix4( obj.matrixWorld );
  obj.userData.points[1].set(  halfCubeletSize, -halfCubeletSize, 0 ).applyMatrix4( obj.matrixWorld );
  obj.userData.points[2].set(  halfCubeletSize,  halfCubeletSize, 0 ).applyMatrix4( obj.matrixWorld );
  obj.userData.points[3].set( -halfCubeletSize,  halfCubeletSize, 0 ).applyMatrix4( obj.matrixWorld );
  obj.userData.points.sort( painterSort );
  return obj.userData.points;
 }
 var sameSide = function(){
  var normal = new THREE.Vector3(),
   origin = new THREE.Vector3(),
   delta = new THREE.Vector3(),
   i = 4;
  return function ( a, points ){
   normal.set( 0, 0, 1 ).transformDirection( a.matrixWorld );
   origin.set( 0, 0, 0 ).applyMatrix4( a.matrixWorld );
   i = 4;
   while( i-- > 0 ){
    delta.subVectors( points[i], origin )
    if(  epsilon( normal.dot( delta )) < 0 ) return false;
   }
   return true;
  }
 }()
 function isEqual( a, b, prop ){
  return a[prop] === b[prop];
 }
 function Intersects( P, Q ){
  return  IntersectsProp( P, Q, 'x' ) &&
    IntersectsProp( P, Q, 'y' ) &&
    IntersectsProp( P, Q, 'z' )
 }
 function smallest( v, p ){
  v.copy( p[0] );
  var i = p.length;
  while( i-- > 0 ){
   v.min( p[i] )
  }
  return v;
 }
 function largest( v, p ){
  v.copy( p[0] );
  var i = p.length;
  while( i-- > 0 ){
   v.max( p[i] )
  }
  return v;
 }
 function sharedEdge( a, b ){
  var sharedVertices = 0;
  var p = a.userData.points.length,
   q = b.userData.points.length;
  while( p-- > 0 ){
   q = b.userData.points.length;
   while( q-- > 0 ){
    if( epsilon( a.userData.points[p].distanceTo( b.userData.points[q] )) === 0 ){
     sharedVertices++;
    }
   }
  }
  return sharedVertices > 1;
 }
 function IntersectsProp( P, Q, prop ){
  return ( Q.userData.max[prop] > P.userData.min[prop] && P.userData.max[prop] > Q.userData.min[prop] );
 }
 var firstRender = true;
 var renderList = [];
 this.render = function ( scene, camera ) {
  fov = 0.5 / Math.tan( THREE.Math.degToRad( camera.fov * 0.5 ) ) * _height;
  domElement.style.WebkitPerspective = fov + "px";
  domElement.style.MozPerspective = fov + "px";
  domElement.style.oPerspective = fov + "px";
  domElement.style.perspective = fov + "px";
  scene.updateMatrixWorld();
  if ( camera.parent === undefined ) camera.updateMatrixWorld();
  camera.matrixWorldInverse.getInverse( camera.matrixWorld );
  screenCenter.makeTranslation( _widthHalf, -_heightHalf, 0 );
  fovOffset.makeTranslation( 0, 0, fov );
  cameraMatrix.copy( screenCenter );
  cameraMatrix.multiply( camera.matrixWorldInverse )
  cameraMatrix.multiply( fovOffset )
  cameraMatrix.elements[1] *= -1;
  cameraMatrix.elements[5] *= -1;
  cameraMatrix.elements[9] *= -1;
  cameraMatrix.elements[13] *= -1;
  renderList = [];
  cube.cubelets.forEach( function(cubelet){
   cubelet.faces.forEach( function(face){
    if( firstRender ){
     if( face.object3D.userData.min === undefined ){
      face.object3D.userData.min = new THREE.Vector3();
      face.object3D.userData.max = new THREE.Vector3();
      face.object3D.userData.points = [
       new THREE.Vector3(),
       new THREE.Vector3(),
       new THREE.Vector3(),
       new THREE.Vector3()
      ]
     }
    }
    renderList.push( face.object3D );
   })
  });
  var sorted, p1z, p2z;
  renderList.sort( function( a, b ){
   sorted = sortVerts( a, camera );
   p1z = sorted[0].z;
   smallest( a.userData.min, sorted );
   largest( a.userData.max, sorted );
   sorted = sortVerts( b, camera );
   p2z = sorted[0].z;
   smallest( b.userData.min, sorted );
   largest( b.userData.max,  sorted );
   a.userData.zIndex = null;
   b.userData.zIndex = null;
   return p1z - p2z;
  })
  var aaa = cube.standing.northWest.front;
  var bbb = cube.front.north.up;
  var p = renderList.length, q, tmp, l = renderList.length;
  for ( p = 0 ; p < l; p ++ ) {
   q = p;
   var P = renderList[p];
   P.userData.zIndex = ( P.userData.zIndex === null ) ? p : P.userData.zIndex;
   for ( q = p; q < l; q ++ ) {
    var Q = renderList[q];
    Q.userData.zIndex = ( Q.userData.zIndex === null ) ? q : Q.userData.zIndex;
    if( Intersects( P, Q ) ) {
     if( sameSide ( P, Q.userData.points )){
      tmp = P.userData.zIndex;
      P.userData.zIndex = Math.min( P.userData.zIndex, q  );
      Q.userData.zIndex = Math.max( tmp, q );
     }
     else if( sameSide ( Q, P.userData.points )){
      tmp = Q.userData.zIndex;
      Q.userData.zIndex = Math.min( Q.userData.zIndex , P.userData.zIndex );
      P.userData.zIndex = Math.max( P.userData.zIndex, tmp  );
     }
    }
   }
  }
  var cam = new THREE.Vector3( 0, 0, -1 ),
   normal = new THREE.Vector3( 0, 0, -1 ),
   facing = false;
   objWorldPosition = new THREE.Vector3();
  for ( var i = 0, l = renderList.length; i < l; i ++ ) {
   renderObject( renderList[ i ], camera );
   objWorldPosition.set( renderList[i].matrixWorld.elements[12], renderList[i].matrixWorld.elements[13], renderList[i].matrixWorld.elements[14] );
   cam.subVectors( objWorldPosition, camera.position );
   facing =  normal.set( 0, 0, 1 ).transformDirection( renderList[i].matrixWorld ).dot( cam ) < 0
   renderList[i].element.style.visibility = facing ? 'visible' : 'hidden';
   if( renderList[i] instanceof THREE.CSS3DObject ) renderList[i].element.style.zIndex = renderList[i].userData.zIndex;
  }
  firstRender = false;
 };
};

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/29/blog-LeadPage/scripts/ierenderer/" data-id="cku52pplp000f98vj7uqod484" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/09/29/blog-LeadPage/scripts/locked/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2021/09/29/blog-LeadPage/scripts/iecss3d/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/09/29/blog-LeadPage/styles/doodle2/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/29/blog-LeadPage/styles/cube/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/29/blog-LeadPage/styles/certificate2/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/29/blog-LeadPage/scripts/tween.r12/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/09/29/blog-LeadPage/scripts/three/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>